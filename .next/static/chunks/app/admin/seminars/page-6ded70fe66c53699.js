(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[507],{780:(e,t,a)=>{Promise.resolve().then(a.bind(a,4296))},4296:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(5155),s=a(2115),l=a(5695),n=a(5992),c=a(728);let o=e=>{let{columns:t,data:a,loading:l,searchTerm:n,onSort:c,onRowClick:o,selectedRows:d=[],onSelectRow:i,onSelectAll:u}=e,[p,m]=(0,s.useState)(""),[y,x]=(0,s.useState)("asc"),b=e=>e.sortable?p!==e.key?"↕️":"asc"===y?"↑":"↓":null;return l?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-full"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})}):(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[i&&(0,r.jsx)("th",{className:"px-6 py-3 text-right typo-body-small font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsx)("input",{type:"checkbox",checked:d.length===a.length&&a.length>0,onChange:e=>{var t;return t=e.target.checked,void(null==u||u(t))},className:"rounded border-gray-300 text-cta focus:ring-cta"})}),t.map(e=>(0,r.jsx)("th",{className:"px-6 py-3 text-right typo-body-small font-medium text-gray-500 uppercase tracking-wider ".concat(e.sortable?"cursor-pointer hover:bg-gray-100":""),onClick:()=>(e=>{if(!e.sortable)return;let t=p===e.key&&"asc"===y?"desc":"asc";m(e.key),x(t),null==c||c(e.key,t)})(e),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{children:e.label}),b(e)&&(0,r.jsx)("span",{className:"mr-2",children:b(e)})]})},e.key))]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===a.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:t.length+ +!!i,className:"px-6 py-12 text-center typo-body-regular text-gray-500",children:"אין נתונים להצגה"})}):a.map((e,a)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 ".concat(o?"cursor-pointer":""),onClick:()=>null==o?void 0:o(e),children:[i&&(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("input",{type:"checkbox",checked:d.includes(e.id),onChange:()=>{var t;return t=e.id,void(null==i||i(t))},onClick:e=>e.stopPropagation(),className:"rounded border-gray-300 text-cta focus:ring-cta"})}),t.map(t=>(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.render?t.render(e[t.key],e):(0,r.jsx)("span",{className:"typo-body-regular text-gray-900",children:e[t.key]})},t.key))]},a))})]})})})},d=e=>{let{seminar:t,onSubmit:a,onCancel:l,loading:n=!1}=e,[c,o]=(0,s.useState)({title:(null==t?void 0:t.title)||"",city:(null==t?void 0:t.city)||"",date:(null==t?void 0:t.date)||"",time_start:(null==t?void 0:t.time_start)||"10:00",time_end:(null==t?void 0:t.time_end)||"14:00",venue_name:(null==t?void 0:t.venue_name)||"",venue_address:(null==t?void 0:t.venue_address)||"",max_participants:(null==t?void 0:t.max_participants)||15,current_participants:(null==t?void 0:t.current_participants)||0,price:(null==t?void 0:t.price)||480,status:(null==t?void 0:t.status)||"active",special_notes:(null==t?void 0:t.special_notes)||"",payment_link:(null==t?void 0:t.payment_link)||""}),[d,i]=(0,s.useState)({}),u=(e,t)=>{o(a=>({...a,[e]:t})),d[e]&&i(t=>({...t,[e]:""}))};return(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{let e={};if(c.city.trim()||(e.city="שם העיר נדרש"),c.date||(e.date="תאריך הסדנה נדרש"),c.time_start||(e.time_start="שעת התחלה נדרשת"),c.time_end||(e.time_end="שעת סיום נדרשת"),c.venue_name.trim()||(e.venue_name="שם המקום נדרש"),c.max_participants<=0&&(e.max_participants="מספר משתתפים מקסימלי חייב להיות גדול מ-0"),c.current_participants<0&&(e.current_participants="מספר משתתפים נוכחי לא יכול להיות שלילי"),c.current_participants>c.max_participants&&(e.current_participants="מספר משתתפים נוכחי לא יכול להיות גדול מהמקסימום"),c.price<=0&&(e.price="מחיר חייב להיות גדול מ-0"),c.payment_link&&c.payment_link.trim())try{new URL(c.payment_link)}catch(t){e.payment_link="כתובת URL לא תקינה"}return i(e),0===Object.keys(e).length})()&&a(c)},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"כותרת הסדנה (אופציונלי)"}),(0,r.jsx)("input",{type:"text",value:c.title,onChange:e=>u("title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-cta focus:border-cta",placeholder:"כותרת מותאמת אישית"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"עיר *"}),(0,r.jsx)("input",{type:"text",value:c.city,onChange:e=>u("city",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-cta focus:border-cta ".concat(d.city?"border-red-500":"border-gray-300"),placeholder:"תל אביב"}),d.city&&(0,r.jsx)("p",{className:"mt-1 typo-body-small text-red-600",children:d.city})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"תאריך *"}),(0,r.jsx)("input",{type:"date",value:c.date,onChange:e=>u("date",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-cta focus:border-cta ".concat(d.date?"border-red-500":"border-gray-300")}),d.date&&(0,r.jsx)("p",{className:"mt-1 typo-body-small text-red-600",children:d.date})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"סטטוס"}),(0,r.jsx)("select",{value:c.status,onChange:e=>u("status",e.target.value),className:"w-full py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-cta focus:border-cta select-rtl",children:[{value:"draft",label:"טיוטה"},{value:"active",label:"פעיל"},{value:"sold_out",label:"אזל המלאי"},{value:"cancelled",label:"בוטל"},{value:"completed",label:"הושלם"}].map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"שעת התחלה *"}),(0,r.jsx)("input",{type:"time",value:c.time_start,onChange:e=>u("time_start",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-cta focus:border-cta ".concat(d.time_start?"border-red-500":"border-gray-300")}),d.time_start&&(0,r.jsx)("p",{className:"mt-1 typo-body-small text-red-600",children:d.time_start})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"שעת סיום *"}),(0,r.jsx)("input",{type:"time",value:c.time_end,onChange:e=>u("time_end",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-cta focus:border-cta ".concat(d.time_end?"border-red-500":"border-gray-300")}),d.time_end&&(0,r.jsx)("p",{className:"mt-1 typo-body-small text-red-600",children:d.time_end})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"שם המקום *"}),(0,r.jsx)("input",{type:"text",value:c.venue_name,onChange:e=>u("venue_name",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-cta focus:border-cta ".concat(d.venue_name?"border-red-500":"border-gray-300"),placeholder:"שם החדר/אולם"}),d.venue_name&&(0,r.jsx)("p",{className:"mt-1 typo-body-small text-red-600",children:d.venue_name})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"כתובת המקום"}),(0,r.jsx)("input",{type:"text",value:c.venue_address,onChange:e=>u("venue_address",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-cta focus:border-cta",placeholder:"כתובת מלאה"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"מספר משתתפים מקסימלי *"}),(0,r.jsx)("input",{type:"number",min:"1",value:c.max_participants,onChange:e=>u("max_participants",parseInt(e.target.value)),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-cta focus:border-cta ".concat(d.max_participants?"border-red-500":"border-gray-300")}),d.max_participants&&(0,r.jsx)("p",{className:"mt-1 typo-body-small text-red-600",children:d.max_participants})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"מספר משתתפים נוכחי *"}),(0,r.jsx)("input",{type:"number",min:"0",value:c.current_participants,onChange:e=>u("current_participants",parseInt(e.target.value)),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-cta focus:border-cta ".concat(d.current_participants?"border-red-500":"border-gray-300")}),d.current_participants&&(0,r.jsx)("p",{className:"mt-1 typo-body-small text-red-600",children:d.current_participants})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"מחיר (₪) *"}),(0,r.jsx)("input",{type:"number",min:"0",step:"1",value:c.price,onChange:e=>u("price",parseInt(e.target.value)),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-cta focus:border-cta ".concat(d.price?"border-red-500":"border-gray-300")}),d.price&&(0,r.jsx)("p",{className:"mt-1 typo-body-small text-red-600",children:d.price})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"הערות מיוחדות"}),(0,r.jsx)("textarea",{value:c.special_notes,onChange:e=>u("special_notes",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-cta focus:border-cta resize-none",placeholder:"הערות נוספות על הסדנה..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block typo-body-regular text-gray-700 mb-2",children:"קישור לתשלום חיצוני"}),(0,r.jsx)("input",{type:"url",value:c.payment_link,onChange:e=>u("payment_link",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-cta focus:border-cta ".concat(d.payment_link?"border-red-500":"border-gray-300"),placeholder:"https://pages.greeninvoice.co.il/payments/links/..."}),d.payment_link&&(0,r.jsx)("p",{className:"mt-1 typo-body-small text-red-600",children:d.payment_link}),(0,r.jsx)("p",{className:"mt-1 typo-body-small text-gray-500",children:"קישור לדף תשלום חיצוני (Green Invoice או מעבד תשלומים אחר)"})]}),(0,r.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,r.jsx)("button",{type:"submit",disabled:n,className:"px-6 py-2 bg-cta text-white typo-button-cta rounded-md hover:bg-cta/90 focus:outline-none focus:ring-2 focus:ring-cta focus:ring-offset-2 disabled:opacity-50",children:n?"שומר...":t?"עדכן סדנה":"צור סדנה"}),(0,r.jsx)("button",{type:"button",onClick:l,className:"px-6 py-2 bg-gray-500 text-white typo-button-regular rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"ביטול"})]})]})};var i=a(9879);function u(){let e=(0,l.useSearchParams)(),[t,a]=(0,s.useState)([]),[u,p]=(0,s.useState)(!0),[m,y]=(0,s.useState)(!1),[x,b]=(0,s.useState)(null),[g,h]=(0,s.useState)([]),[v,f]=(0,s.useState)({status:[],search:""});(0,s.useEffect)(()=>{"true"===e.get("new")&&y(!0)},[e]);let j=(0,s.useCallback)(async()=>{try{p(!0);let e=await i.Y.fetchAllSeminars({status:v.status});a(e)}catch(e){console.error("Error fetching seminars:",e)}finally{p(!1)}},[v.status]);(0,s.useEffect)(()=>{j()},[j]);let N=async e=>{try{await i.Y.createSeminar(e),y(!1),j()}catch(e){console.error("Error creating seminar:",e)}},_=async e=>{if(x)try{await i.Y.updateSeminar(x.id,e),b(null),y(!1),j()}catch(e){console.error("Error updating seminar:",e)}},w=async e=>{if(window.confirm("האם אתה בטוח שברצונך למחוק את הסדנה?"))try{await i.Y.deleteSeminar(e),j()}catch(e){console.error("Error deleting seminar:",e)}},k=async()=>{if(0!==g.length&&window.confirm("האם אתה בטוח שברצונך למחוק ".concat(g.length," סדנאות? פעולה זו בלתי הפיכה!")))try{for(let e of g)await i.Y.deleteSeminar(e);h([]),j(),alert("".concat(g.length," סדנאות נמחקו בהצלחה"))}catch(e){console.error("Error deleting seminars:",e),alert("שגיאה במחיקת הסדנאות")}},C=e=>e.slice(0,5),S=[{key:"city",label:"עיר",sortable:!0},{key:"date",label:"תאריך",sortable:!0,render:e=>new Date(e).toLocaleDateString("he-IL")},{key:"time_start",label:"שעה",render:(e,t)=>"".concat(C(e)," - ").concat(C(t.time_end))},{key:"venue_name",label:"מקום",sortable:!0},{key:"current_participants",label:"משתתפים",render:(e,t)=>"".concat(e,"/").concat(t.max_participants)},{key:"price",label:"מחיר",render:e=>"₪".concat(e)},{key:"status",label:"סטטוס",render:e=>(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs ".concat(i.Y.getStatusColor(e)),children:i.Y.getStatusLabel(e)})},{key:"actions",label:"פעולות",render:(e,t)=>(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),b(t),y(!0)},className:"text-blue-600 hover:text-blue-800 typo-body-small",children:"ערוך"}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),w(t.id)},className:"text-red-600 hover:text-red-800 typo-body-small",children:"מחק"})]})}];return m?(0,r.jsx)(c.A,{children:(0,r.jsx)(n.A,{children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("h1",{className:"typo-section-title text-bg-primary",children:x?"עריכת סדנה":"יצירת סדנה חדשה"})}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,r.jsx)(d,{seminar:x||void 0,onSubmit:x?_:N,onCancel:()=>{y(!1),b(null)}})})]})})}):(0,r.jsx)(c.A,{children:(0,r.jsx)(n.A,{children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"typo-section-title text-bg-primary",children:"ניהול סדנאות"}),(0,r.jsx)("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-cta text-white typo-button-cta rounded-md hover:bg-cta/90",children:"הוסף סדנה"})]}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"typo-body-regular text-gray-700",children:"סטטוס:"}),(0,r.jsx)("button",{onClick:()=>f(e=>({...e,status:[]})),className:"px-3 py-1 rounded-full text-xs transition-colors ".concat(v.status&&0!==v.status.length?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-cta text-white"),children:"הצג הכל"}),["active","draft","sold_out","cancelled","completed"].map(e=>{var t;return(0,r.jsx)("button",{onClick:()=>{f(t=>{var a;return{...t,status:(null==(a=t.status)?void 0:a.includes(e))?[]:[e]}})},className:"px-3 py-1 rounded-full text-xs transition-colors ".concat((null==(t=v.status)?void 0:t.includes(e))?"bg-cta text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:i.Y.getStatusLabel(e)},e)})]}),(0,r.jsx)("div",{className:"flex-1 max-w-sm",children:(0,r.jsx)("input",{type:"text",placeholder:"חיפוש...",value:v.search,onChange:e=>f(t=>({...t,search:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-cta focus:border-cta"})})]})}),g.length>0&&(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"typo-body-regular text-blue-800",children:[g.length," פריטים נבחרו"]}),(0,r.jsx)("div",{className:"flex gap-2",children:(0,r.jsx)("button",{onClick:k,className:"px-3 py-1 bg-red-600 text-white rounded typo-body-small hover:bg-red-700",children:"מחק נבחרים"})})]})}),(0,r.jsx)(o,{columns:S,data:t,loading:u,selectedRows:g,onSelectRow:e=>{h(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},onSelectAll:e=>{h(e?t.map(e=>e.id):[])}})]})})})}}},e=>{e.O(0,[121,76,358],()=>e(e.s=780)),_N_E=e.O()}]);